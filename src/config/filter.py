"""
src.config.filter

会話ログから除外したい定型ハルシネーション（例: 配信締めのあいさつ）を
一元管理する設定モジュール。

- `BANNED_HALLUCINATIONS`: 除外対象のフレーズ集合（完全一致で判定）
- `is_banned(text)`: 入力テキストが禁止フレーズに該当するかを判定

運用方針:
- 完全一致でのみ弾く（過剰除去を避けるため）
- 代表的な「ご視聴ありがとうございました」や「ありがとうございました」等のバリエーションを登録
"""

from __future__ import annotations

from typing import Iterable


# 完全一致で除外する文言リスト（必要に応じて追加）
BANNED_HALLUCINATIONS = {
    "ご視聴ありがとうございました",
    "ご視聴ありがとうございました。",
    "ご視聴ありがとうございました！",
    "チャンネル登録よろしくお願いします",
    "チャンネル登録よろしくお願いします。",
    "チャンネル登録よろしくお願いします！",
    "チャンネル登録",
    "チャンネル登録。",
    "チャンネル登録！",
    "チャンネル登録と高評価",
    "チャンネル登録と高評価。",
    "チャンネル登録と高評価！",
    "チャンネル登録と高評価よろしくお願いします",
    "チャンネル登録と高評価よろしくお願いします。",
    "チャンネル登録と高評価よろしくお願いします！",
    # 追加要望: シンプルな「ありがとうございました」も除外
    "ありがとうございました",
    "ありがとうございました。",
    "ありがとうございました！",
}


def is_banned(text: str, banned: Iterable[str] = BANNED_HALLUCINATIONS) -> bool:
    """禁止フレーズかどうかを完全一致で判定する。

    - 前後空白は無視
    - 大文字小文字は日本語では影響しないため現状未考慮
    """
    s = (text or "").strip()
    return s in banned

